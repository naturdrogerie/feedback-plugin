"use strict";(self.webpackChunkplentymarkets_feedback=self.webpackChunkplentymarkets_feedback||[]).push([[4],{4304:function(e,t,a){a.d(t,{A:function(){return l}});a(8940);let s=!1,r=!1;const n={setFeedbackAuthenticatedUser(e,t){e.authenticatedUser=t},setFeedbackCounts(e,t){e.counts=t},setFeedbacks(e,t){e.feedbacks=e.feedbacks.concat(t)},setFeedbackItemAttributes(e,t){e.itemAttributes=t},setFeedbackPagination(e,t){e.pagination.lastPage=t.lastPage,e.pagination.isLastPage=t.isLastPage},incrementCurrentFeedbackPage(e){e.pagination.currentPage++},addFeedback(e,t){if(e.authenticatedUser.feedbacks.unshift(t),t.isVisible){const a=parseInt(t.feedbackRating.rating.ratingValue);a>0&&a<=5&&(e.counts["ratingsCountOf"+a]++,e.counts.ratingsCountTotal++,f(e))}},deleteFeedback(e,{feedbackId:t,parentFeedbackId:a,feedback:s}){if(s.isVisible&&null===a){const t=parseInt(s.feedbackRating.rating.ratingValue);t>0&&t<=5&&(e.counts["ratingsCountOf"+t]--,e.counts.ratingsCountTotal--,f(e))}null===a?(e.feedbacks=u(e.feedbacks,t),e.authenticatedUser.feedbacks=u(e.authenticatedUser.feedbacks,t)):(e.feedbacks=d(e.feedbacks,a,t),e.authenticatedUser.feedbacks=d(e.authenticatedUser.feedbacks,a,t))}},i={loadFeedbackUser({commit:e},{itemId:t,variationId:a}){if(!r){r=!0;let s="";return void 0!==t&&void 0!==a&&(s=`/${t}/${a}`),$.ajax({type:"GET",url:"/rest/feedbacks/user"+s,success:function(t){e("setFeedbackAuthenticatedUser",t),r=!1},error:function(e,t,a){r=!1,console.error(a)}})}},loadFeedbackCounts({commit:e,state:t},a){if(!c)return c=!0,$.ajax({type:"GET",url:"/rest/feedbacks/feedback/helper/counts/"+a,success:function(t){e("setFeedbackCounts",t.counts)},error:function(e,t,a){console.error(a)}})},loadPaginatedFeedbacks({commit:e,state:t},{itemId:a,feedbacksPerPage:r}){if(!s){s=!0;const n=$.ajax({type:"GET",url:"/rest/feedbacks/feedback/helper/feedbacklist/"+a+"/"+t.pagination.currentPage,data:{feedbacksPerPage:r},success:function(t){e("setFeedbacks",t.feedbacks),e("setFeedbackItemAttributes",t.itemAttributes),e("setFeedbackPagination",t.pagination),s=!1},error:function(e,t,a){console.error(a),s=!1}});return e("incrementCurrentFeedbackPage"),n}},deleteFeedback({commit:e,state:t},{feedbackId:a,parentFeedbackId:s,feedback:r}){return $.ajax({type:"DELETE",url:"/rest/feedbacks/feedback/delete/"+a,success:t=>{e("deleteFeedback",{feedbackId:a,parentFeedbackId:s,feedback:r})}})}};let c=!1;var o={state:()=>({authenticatedUser:{},counts:{},feedbacks:[],itemAttributes:[],pagination:{isLastPage:!0,lastPage:1,currentPage:1}}),mutations:n,actions:i,getters:{}};function u(e,t){return e.filter((function(e){return e.id!==t}))}function d(e,t,a){return e.map((function(e){return t===e.id&&(e.replies=e.replies.filter((function(e){return e.id!==a}))),e}))}function f(e){let t=0;t+=5*e.counts.ratingsCountOf5,t+=4*e.counts.ratingsCountOf4,t+=3*e.counts.ratingsCountOf3,t+=2*e.counts.ratingsCountOf2,t+=1*e.counts.ratingsCountOf1,t/=e.counts.ratingsCountTotal,e.counts.averageValue=t}var l={created(){this.$store.hasModule("feedback")||App.isSSR||this.$store.registerModule("feedback",o,{preserveState:!!this.$store.state.feedback})}}},1957:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showEmptyRatings||e.counts.averageValue>0?a("div",{staticClass:"feedback-stars-average",class:e.size},[a("div",{staticClass:"feedback-stars-background clearfix"},e._l(5,(function(e){return a("div",{key:"star_background_"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0),e._v(" "),a("div",{staticClass:"feedback-stars-overlay-wrap",style:{width:e.fill}},[a("div",{staticClass:"feedback-stars-overlay clearfix"},e._l(5,(function(e){return a("div",{key:"star_overlay_"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0)])]):e._e(),e._v(" "),e.showRatingsAmount&&(e.showEmptyRatings||e.counts.averageValue>0)?a("span",{class:e.size},[a("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.scrollTo(t)}}},[e._v("("+e._s(e.counts.ratingsCountTotal)+")")])]):e._e()])};s._withStripped=!0;a(9463);var r=a(5353);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c={name:"FeedbackAverage",mixins:[a(4304).A],inject:{itemId:{default:null}},props:{showEmptyRatings:Boolean,sizeOfStars:{type:String,default:"small"},showRatingsAmount:Boolean},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({fill(){let e=100*this.counts.averageValue/5;return e+="%",e},size(){return-1!==this.sizeOfStars.indexOf("-stars")?this.sizeOfStars:this.sizeOfStars+"-stars"}},(0,r.aH)({counts:e=>e.feedback.counts})),mounted(){App.isShopBuilder||this.getAverage()},methods:{getAverage(){this.$store.dispatch("loadFeedbackCounts",this.itemId)},scrollTo(){let e=document.querySelector("[data-feedback]");const t=document.querySelector("#vue-app").offsetTop;if(e){for(;(!e.clientHeight||!e.classList.contains("widget"))&&e.parentElement;)e=e.parentElement;if(e){const a=e.getBoundingClientRect().top+window.scrollY-t;window.scrollTo({top:a,behavior:"smooth"})}}}}},o=c,u=(0,a(4486).A)(o,s,[],!1,null,null,null).exports}}]);
//# sourceMappingURL=feedback-4.min.js.map